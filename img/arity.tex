\documentclass{standalone}

\input{common.tex}

\providecommand{\datatable}{arity.csv}
\providecommand{\problemsize}{2048}

\begin{document}

\begin{tikzpicture}[
  every axis/.style={
    % common settings
  },
]

\begin{axis}[
    ylabel=compute time,
    y SI prefix=micro,y unit=s,
    xlabel={arity for $N=\problemsize$},
    xticklabels from table={\datatable}{arity},
    xtick=data,
    ytick pos=left
]

\addplot     +[error bars/.cd, y dir=both, y explicit] %
         table[x=arity,y=kernel_runtime,y error=kernel_runtime_err,
               /tr/rowfilter={problem_size}{\problemsize}]{\datatable};

\end{axis}

\begin{axis}[
    axis y line*=right,
    axis x line=none,
    ymin=0, ymax=1,
    ylabel={achieved occupancy},
    ylabel style={rotate=-180},
    yticklabel={\pgfmathparse{\tick*100}\pgfmathprintnumber{\pgfmathresult}\%}
]

\addplot      [ybar, pattern=north east lines] %
         table[x=arity,y=kernel_occupancy, /tr/rowfilter={problem_size}{\problemsize}]{\datatable};

\end{axis}

\end{tikzpicture}

\end{document}
